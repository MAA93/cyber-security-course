# DAY 8 - VULNERABILITY ASSESSMENT & ACCESS CONTROL | CCT-VA-AC-008
**Mode:** Practical (lab server). Run scans and safely apply access-control changes in a controlled lab environment.

---

### 1) SSH into your lab server
```bash
ssh [your-username]@[your-server-ip]
```

---

### 2) Quick system audit with Lynis
```bash
sudo apt update
sudo apt install -y lynis
sudo lynis audit system > CCT-VA-AC-008-lynis.txt 2>&1
```
*Explanation:*  
- `sudo apt update` refreshes the package list to ensure you install the latest software.  
- `sudo apt install -y lynis` installs Lynis, a tool for auditing Linux systems.  
- `sudo lynis audit system` runs a full system audit.  
- `> CCT-VA-AC-008-lynis.txt 2>&1` saves both standard output and errors to a file so you can review warnings and suggested security improvements later.

---

### 3) Nmap service & vuln checks
```bash
nmap -sV -sC [lab-server-ip] -oN CCT-VA-AC-008-nmap-scripts.txt
nmap --script vuln [lab-server-ip] -oN CCT-VA-AC-008-nmap-vuln.txt
```
*Explanation:*  
- `nmap -sV -sC` scans for open ports, service versions, and runs default scripts for basic info gathering.  
- `nmap --script vuln` runs vulnerability scripts against your lab server to identify known weaknesses.  
- `-oN` outputs results in a human-readable text file.  
- Always run these only against lab servers you control to avoid legal issues.

---

### 4) Example remediations (this is just for info -- Don't do it)
```bash
sudo apt update && sudo apt upgrade -y
sudo systemctl stop vsftpd
sudo systemctl disable vsftpd
sudo apt remove -y telnetd || true
```
*Explanation:*  
- `sudo apt update && sudo apt upgrade -y` updates all packages to the latest versions, fixing known vulnerabilities.  
- `sudo systemctl stop vsftpd` stops the FTP server if it is running.  
- `sudo systemctl disable vsftpd` prevents the FTP server from starting on boot.  
- `sudo apt remove -y telnetd || true` removes Telnet service (unsecure) if installed. `|| true` prevents errors if telnetd isn’t installed.

---

### 5) Access control hardening
```bash
sudo getent group sudo
sudo visudo -c
sudo cat /etc/sudoers.d/* 2>/dev/null || true
```
*Explanation:*  
- `sudo getent group sudo` lists users in the sudo group.  
- `sudo visudo -c` checks the sudoers file for syntax errors to avoid breaking sudo access.  
- `sudo cat /etc/sudoers.d/*` shows all custom sudo rules in `/etc/sudoers.d/`. `2>/dev/null || true` ignores errors if no files exist.

```bash
sudo useradd -m -s /bin/bash cct-limited
sudo passwd cct-limited
```
*Explanation:*  
- `sudo useradd -m -s /bin/bash cct-limited` creates a new user `cct-limited` with a home directory and Bash shell.  
- `sudo passwd cct-limited` sets the password for the new user.

```bash
echo 'cct-limited ALL=(root) NOPASSWD: /bin/systemctl restart apache2' \
  | sudo tee /etc/sudoers.d/cct-limited-service
sudo chmod 440 /etc/sudoers.d/cct-limited-service
```
*Explanation:*  
- This allows `cct-limited` to restart the Apache server without needing a password.  
- `chmod 440` ensures proper permissions on the sudoers file so it’s secure.

```bash
sudo setfacl -m u:cct-limited:rw /var/www/html/somefile.txt
getfacl /var/www/html/somefile.txt > CCT-VA-AC-008-acl-example.txt
```
*Explanation:*  
- `setfacl -m u:cct-limited:rw` gives read/write access to `cct-limited` for a specific file, without changing the owner/group.  
- `getfacl` exports the ACL settings so you can document permissions applied.

---

### 6) Verification & re-scan
```bash
sudo systemctl status apache2 > CCT-VA-AC-008-apache-status.txt
nmap -sV -sC [lab-server-ip] -oN CCT-VA-AC-008-nmap-after-fix.txt
```
*Explanation:*  
- `systemctl status apache2` checks the status of the Apache service and saves it to a file.  
- `nmap -sV -sC` re-scans the server to verify that your remediations and access control changes didn’t break services or leave open vulnerabilities.


## SUBMISSION

### Step 1 — Email
*Explanation:* Students must submit evidence of their work via email. Make sure all requested files are attached.  

- **To:** `support@ucubetech.com`  
- **Subject:** `CCT-VA-AC-008 Submission - [Your Name]`  

**Attach the following files:**  
- `CCT-VA-AC-008-lynis.txt` — contains the Lynis system audit report.  
- `CCT-VA-AC-008-nmap-scripts.txt` — output from Nmap service discovery and default scripts.  
- `CCT-VA-AC-008-nmap-vuln.txt` — output from Nmap vulnerability scripts.  
- `CCT-VA-AC-008-findings.txt` — your top 5 prioritized findings and remediation steps.  
- `CCT-VA-AC-008-acl-example.txt` — example ACL applied to a file for access control verification.  
- *(Optional)* `CCT-VA-AC-008-openvas-report.pdf` — if OpenVAS/Greenbone was used.

*Tip:* Double-check that file names match exactly and that your findings are clearly documented.

---

### Step 2 — Microsoft Forms
*Explanation:* This form submission ensures instructors can quickly verify completion of tasks.  

- **Complete the form:** [https://forms.office.com/r/Pr4aYf6atB](https://forms.office.com/r/Pr4aYf6atB)  
- Fill in your name, lab server IP (if required), and summary of actions taken.  
- Attach or reference the same files you emailed, if requested.

*Note:* Submitting both email and form ensures your work is properly recorded and graded.
