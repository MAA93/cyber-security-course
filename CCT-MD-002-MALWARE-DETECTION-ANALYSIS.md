# DAY 2 - MALWARE DETECTION & ANALYSIS | TASK ID: CCT-MD-002

## LEARN (15 min)
Malware (Malicious Software) is designed to harm, exploit, or illegally access computer systems. It can enter through malicious downloads, email attachments, compromised software, or network vulnerabilities. While Linux is more secure by design, it is not immune. Security professionals use a combination of antivirus scanners, rootkit detectors, system auditing tools, and rule-based scanners to perform triage and investigation.

---

## RESOURCES
- **Read:** [ClamAV Official Documentation](https://docs.clamav.net/)  
- **Read:** [Lynis Security Audit](https://cisofy.com/lynis/)  
- **Watch:** "Introduction to Malware Analysis on Linux" - https://youtu.be/2TofunAI6fU (15 min)  
- **Reference:** [EICAR Test Virus](https://www.eicar.org/download-anti-malware-testfile/) - Safe file for testing AV detection  

---

## TOOLS USED
- **ClamAV** → signature-based antivirus scanning  
- **rkhunter** → rootkit detection  
- **Lynis** → system auditing and security hardening  

---

## EICAR TEST FILE
The EICAR test file is a harmless ASCII string used to test antivirus scanners. Save this exact text as `eicar_test.txt`:

```
X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
```

---

## DO (40 min) — Malware Hunt

### 1. SSH into your lab server
```bash
ssh [your-username]@[your-server-ip]
```

### 2. Install modern security tools (Skip--already installed)
```bash
sudo apt update
sudo apt install -y clamav clamav-daemon rkhunter lynis
```

### 3. Update ClamAV database (Skip--already updated)
```bash
sudo systemctl stop clamav-freshclam
sudo freshclam
sudo systemctl start clamav-freshclam
```

### 4. Create the EICAR test file
```bash
echo 'X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*' > $HOME/eicar_test.txt
```
### 5. Run the scans
```bash
# ----------------------------------------
# 1️⃣ Scan only the EICAR test file with ClamAV
# May take a few seconds
clamscan -i $HOME/eicar_test.txt > CCT-MD-002-clamav.txt 2>&1

# ----------------------------------------
# 2️⃣ Check for rootkits with rkhunter
# First-time scans may take several minutes
sudo rkhunter --check --sk > CCT-MD-002-rkhunter.txt 2>&1

# ----------------------------------------
# 3️⃣ Perform a system audit with Lynis
# This may take several minutes depending on your system
sudo lynis audit system > CCT-MD-002-lynis.txt 2>&1
```

### 6. Analyze and summarize
Create `CCT-MD-002-summary.txt` and answer:
- Did ClamAV detect `eicar_test.txt`? What threat name was given?  
- Did rkhunter or Lynis report any warnings?  
- What actions would you recommend (quarantine, patch, further analysis)?  

```bash
nano CCT-MD-002-summary.txt
```

---

## SUBMISSION

### Step 1 — Email
- **To:** `support@ucubetech.com`  
- **Subject:** `CCT-MD-002 Submission - [Your Name]`  
- **Attachments:**  
  - `CCT-MD-002-clamav.txt`  
  - `CCT-MD-002-rkhunter.txt`  
  - `CCT-MD-002-lynis.txt`  
  - `CCT-MD-002-summary.txt`  

### Step 2 — Microsoft Forms
- **Complete the form:** [https://forms.office.com/r/Pr4aYf6atB](https://forms.office.com/r/Pr4aYf6atB)
---

## GOAL
Understand the **practical process of malware detection** on Linux. Learn to use modern tools, interpret outputs, and document findings like a security analyst. Success is not a clean scan, but correctly identifying and reporting threats.

---

## OPTIONAL ADVANCED
- Use **Cuckoo Sandbox** to observe malware behavior dynamically  
- Capture memory and analyze with **Volatility**  
- Use **REMnux VM** for reverse engineering malware binaries  
- Analyze executables with **Ghidra**
